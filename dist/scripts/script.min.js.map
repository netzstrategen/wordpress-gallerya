{"version":3,"sources":["../assets/scripts/script.js"],"names":["$","document","ready","setProductGalleryVideoSlide","$galleryWraper","$galleryElements","children","length","$firstGalleryElement","first","hasClass","detach","insertAfter","setProductGalleryVideoThumbnail","$videoContent","videoThumbSrc","data","$sliderThumbs","videoThumbPos","videoThumb","eq","attr","parent","addClass","setVideoPlayerUrl","slideIndex","slide","$videoPlayer","find","restoreSliderThumbs","$slider","hiddenSlides","show","flickity","fn","arrowShape","each","index","element","galleryaSlider","this","closest","navigation","pageDots","thumbnails","count","sliderArgs","cellAlign","contain","wrapAround","imagesLoaded","watchCSS","lazyLoad","flickityData","thumbnailsArgs","asNavFor","groupCells","on","selectedIndex","className","removeClass","slideNumber","text","slides","e","target","event","stopPropagation","lightGallery","thumbnail","showThumbByDefault","subHtmlSelectorRelative","selector","$thumbnailSliderEl","thumbnailSliderArgs","thumbnailSpacingUnit","parseInt","getComputedStyle","get","getPropertyValue","thumbnailSliderMargin","initialImgsWidth","width","thumbnailSliderWidth","maxCols","noCols","style","setProperty","pointer","cellElement","cellIndex","$thumbnailSlider","$singleVariation","productGallery","flexslider","currentTarget","variation","selectedVariationImages","product_variation_images","gallery","variation_id","$this","thumb","includes","hide","thumbnailIndex","image","gallery_thumbnail_src","firstImage","parents","jQuery"],"mappings":"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","file":"script.min.js","sourcesContent":["(function ($) {\n  $(document).ready(function () {\n\n    // Adds slide navigation through variation thumbnails for variable products\n    // displayed in products listings.\n    if ($('.js-gallerya-slider').length > 0 && typeof $.fn.flickity === 'function') {\n      const arrowShape = 'M85,50.36033a2.72075,2.72075,0,0,0-2.74945-2.68906H24.01177L47.61119,24.59022a2.65667,2.65667,0,0,0,0-3.80232,2.79411,2.79411,0,0,0-3.88955,0L15.80559,48.09077a2.64614,2.64614,0,0,0,0,3.80232L43.729,79.21211a2.79185,2.79185,0,0,0,3.88771,0,2.64613,2.64613,0,0,0,0-3.80233L24.756,53.04939h57.4946A2.72075,2.72075,0,0,0,85,50.36033Z';\n\n      $('.js-gallerya-slider').each(function (index, element) {\n        const galleryaSlider = $(this).closest('.gallerya--slider, .gallerya--product-variation-slider');\n        const navigation = galleryaSlider.data('gallerya-navigation');\n        const pageDots = galleryaSlider.data('galleryaPageDots');\n        const thumbnails = galleryaSlider.find('.js-gallerya-thumbnail-slider');\n        const count = galleryaSlider.find('[data-gallerya-count]');\n        const sliderArgs = {\n          cellAlign: 'left',\n          contain: true,\n          wrapAround: true,\n          imagesLoaded: true,\n          watchCSS: true,\n          lazyLoad: true,\n        };\n\n        if (!galleryaSlider.hasClass('gallerya--product-variation-slider')) {\n          sliderArgs.arrowShape = arrowShape;\n        }\n        if (typeof pageDots !== 'undefined') {\n          // Let the pageDots property be overriden by a data-attribute.\n          sliderArgs.pageDots = pageDots == true;\n        }\n        else if (typeof navigation === 'undefined' || navigation == false || thumbnails.length > 0) {\n          sliderArgs.pageDots = false;\n        }\n\n        // Adjust styling before slider init.\n        $(this).addClass('flickity');\n        $(this).flickity(sliderArgs);\n\n        const flickityData = $(this).data('flickity');\n        if (thumbnails.length > 0) {\n          const thumbnailsArgs = {\n            asNavFor: element,\n            contain: true,\n            pageDots: false,\n            imagesLoaded: true,\n            groupCells: true,\n            arrowShape: arrowShape,\n          };\n          thumbnails.flickity(thumbnailsArgs);\n\n          $(this).on('select.flickity', function () {\n            const index = flickityData.selectedIndex;\n            const className = 'is-currently-selected';\n            thumbnails.find('.flickity-slider li').removeClass(className)\n              .eq(index).addClass(className);\n          });\n        }\n        if (count) {\n          $(this).on('select.flickity', function () {\n            const slideNumber = flickityData.selectedIndex + 1;\n            count.text(slideNumber + '/' + flickityData.slides.length);\n          });\n        }\n      });\n\n      $('.woocommerce-loop-product__link').on('click', function (e) {\n        // Prevent clicks onto slider arrows to bubble through to wrapping product link.\n        if ($(e.target).closest('.flickity-prev-next-button').length !== 0){\n          event.stopPropagation();\n          return false;\n        }\n      });\n    }\n\n    // Adds lightbox functionality to product gallery.\n    if (typeof $.fn.lightGallery === 'function') {\n      $('.js-gallerya-lightbox').lightGallery({\n        thumbnail: true,\n        showThumbByDefault: false,\n        subHtmlSelectorRelative: true,\n        selector: '.gallerya__image > a'\n      });\n      $('.woocommerce-product-gallery').lightGallery({\n        thumbnail: true,\n        showThumbByDefault: false,\n        subHtmlSelectorRelative: true,\n        selector: '.woocommerce-product-gallery__image > a'\n      });\n    }\n\n    // Adds thumbnails slider to product gallery on product detail page.\n    if ($('.js-gallerya-product-thumbnail-slider').length > 0 && typeof $.fn.flickity === 'function') {\n      const $thumbnailSliderEl = $('.js-gallerya-product-thumbnail-slider').parent().find('.flex-control-thumbs').first();\n\n      if (!$thumbnailSliderEl.length) {\n        return;\n      }\n\n      const thumbnailSliderArgs = {\n        contain: true,\n        pageDots: false,\n        imagesLoaded: true,\n        groupCells: true,\n      };\n\n      // Calculate # of cols, given the initial images width as the minimum, at least 4 cols.\n      const thumbnailSpacingUnit  = parseInt(getComputedStyle($thumbnailSliderEl.get(0)).getPropertyValue('--thumbnail-spacing-unit'), 10);\n      const thumbnailSliderMargin = parseInt(getComputedStyle($thumbnailSliderEl.get(0)).getPropertyValue('--thumbnail-slider-margin'), 10);\n      const initialImgsWidth = $thumbnailSliderEl.find('li').first().width();\n      const thumbnailSliderWidth = $thumbnailSliderEl.width();\n      const maxCols = 7;\n      let noCols = 4;\n\n      if (initialImgsWidth > 0 && thumbnailSliderWidth > initialImgsWidth) {\n        while (((thumbnailSliderWidth - (2 * thumbnailSliderMargin)) - (thumbnailSpacingUnit * noCols)) / (noCols + 1) >= initialImgsWidth) {\n          noCols++;\n          if (noCols === maxCols) {\n            break;\n          }\n        }\n        // Update # of cols in css vars.\n        $thumbnailSliderEl.get(0).style.setProperty('--thumbnail-count', noCols);\n      }\n\n      // Add video player and video thumbnail to the product gallery.\n      $thumbnailSliderEl\n        .addClass('flickity')\n        .on('ready.flickity', function () {\n          setProductGalleryVideoSlide();\n        })\n        .on('settle.flickity', function () {\n          setProductGalleryVideoThumbnail();\n        })\n        .on('staticClick.flickity', function (event, pointer, cellElement, cellIndex) {\n          if ($(cellElement).hasClass('slider-thumb-video')) {\n            setVideoPlayerUrl(cellIndex);\n          }\n        });\n      // Initialise the thumbnail slider.\n      const $thumbnailSlider = $thumbnailSliderEl.flickity(thumbnailSliderArgs);\n      const $singleVariation = $('.single_variation_wrap');\n      // Initially no slide is hidden.\n      $thumbnailSliderEl.hiddenSlides = 0;\n\n      // Selects the slide in the product gallery when the user hovers over the\n      // thumbnail images.\n      const productGallery = $('.woocommerce-product-gallery').data('flexslider');\n      if (productGallery) {\n        $thumbnailSlider.on('mouseover', 'li', function (event) {\n          productGallery.flexslider($(event.currentTarget).index());\n        });\n      }\n\n      // Reacts to product variation selection.\n      $singleVariation.on('show_variation', function (event, variation) {\n        restoreSliderThumbs($thumbnailSliderEl);\n        // If selected variation has its own images gallery, only show those\n        // and hide any other thumbnails.\n        const productGallery = product_variation_images.gallery;\n        const selectedVariationImages = product_variation_images[variation.variation_id];\n        if (selectedVariationImages.length > 1) {\n          $thumbnailSliderEl.find('img').each(function () {\n            const $this = $(this);\n            const thumb = $this.attr('src');\n            // Hide the image if its not in the selected variation gallery.\n            if (!selectedVariationImages.includes(thumb)) {\n              $this.parent().hide();\n              $thumbnailSliderEl.hiddenSlides++;\n            }\n          });\n          if ($thumbnailSliderEl.hiddenSlides) {\n            $thumbnailSliderEl.flickity('reposition');\n          }\n        }\n        // Get the index of the variation thumbnail in the thumbnail slider.\n        const thumbnailIndex = $thumbnailSliderEl\n          .find('img[src=\"' + variation.image.gallery_thumbnail_src + '\"]')\n          .parent()\n          .index();\n        // Select the variation thumbnail in the thumbnail slider.\n        $thumbnailSliderEl.flickity('selectCell', thumbnailIndex);\n      });\n\n      // Reacts to product variation selection reset.\n      $singleVariation.on('hide_variation', function (event) {\n        if ($thumbnailSliderEl.hiddenSlides) {\n          restoreSliderThumbs($thumbnailSliderEl);\n          $thumbnailSliderEl.hiddenSlides = 0;\n        }\n      });\n    }\n    else {\n      // Flickity is not active.\n      setProductGalleryVideoSlide();\n      setProductGalleryVideoThumbnail();\n      $('.single-product-summary .flex-control-nav li').on('click', function () {\n        const $this = $(this);\n        if ($this.hasClass('slider-thumb-video')) {\n          setVideoPlayerUrl($this.index());\n        }\n      });\n    }\n\n    /**\n     * Modifies data-srcset of product gallery first image on variation change.\n     *\n     * lightGallery gets the srcset from the anchor element that wraps the\n     * image. On variation change, WooCommerce changes the srcset of the first\n     * product image with the variation one, but not the srcset of the wrapping\n     * anchor element.\n     */\n    $('.variations_form').on('woocommerce_variation_has_changed', function () {\n      const firstImage = $('.woocommerce-product-gallery__image img').eq(0);\n      if (firstImage.length) {\n        firstImage.parents('[data-srcset]').attr('data-srcset', firstImage.attr('srcset'));\n      }\n    });\n\n    /**\n     * Swaps first and second slide of product gallery, if first is a video.\n     */\n    function setProductGalleryVideoSlide() {\n      // Video should be the second element in the product gallery.\n      const $galleryWraper = $('.woocommerce-product-gallery .woocommerce-product-gallery__wrapper');\n      const $galleryElements = $galleryWraper.children('div');\n      if ($galleryElements.length <= 1) {\n        return;\n      }\n      const $firstGalleryElement = $galleryElements.first();\n      if ($firstGalleryElement.hasClass('has-video')) {\n        // Set video as second slide.\n        $firstGalleryElement\n          .detach()\n          .insertAfter($galleryWraper.children('div').first());\n      }\n    }\n\n    /**\n     * Swaps first and second thumbnail of product gallery, if first is a video.\n     */\n    function setProductGalleryVideoThumbnail() {\n      const $videoContent = $('.woocommerce-product-gallery .gallerya__video-content').first();\n      // If there's no video content, exit.\n      if ($videoContent.length < 1) {\n        return;\n      }\n      const videoThumbSrc = $videoContent.data('video-thumb');\n      const $sliderThumbs = $('.flex-control-nav li img');\n      // Video thumb should be the second element in the slider,\n      // unless there's only one slide.\n      const videoThumbPos = $sliderThumbs.length > 1 ? 1 : 0;\n      const videoThumb = $sliderThumbs.eq(videoThumbPos);\n      // Avoid switching thumbnails if second thumb is already the video.\n      if (videoThumb.attr('src') !== videoThumbSrc) {\n        $sliderThumbs.first().attr('src', videoThumb.attr('src'));\n        videoThumb\n          .attr('src', videoThumbSrc)\n          // Ensure lazy loaded image is the video thumbnail.\n          .attr('data-lazy-src', videoThumbSrc)\n          .parent().addClass('slider-thumb-video');\n      }\n    }\n\n    /**\n     * Sets the URL of the video slide referred by a video thumbnail.\n     *\n     * Initially we don't set video URL in the video slide iframe to avoid\n     * loading it if unless it is displayed.\n     * If the thumbnail clicked refers to a video slide, then we assign\n     * the video URL to the player iframe.\n     *\n     * @param {int} slideIndex\n     *   Index of the thumbnail and the slide in the product gallery.\n     */\n    function setVideoPlayerUrl(slideIndex) {\n      const slide = $('.woocommerce-product-gallery .woocommerce-product-gallery__image').eq(slideIndex);\n      if (!$(slide).hasClass('has-video')) {\n        return;\n      }\n      const $videoPlayer = $(slide).find('iframe').first();\n      if (!$videoPlayer.attr('src')) {\n        $videoPlayer.attr('src', $(slide).data('video-url'));\n      }\n    }\n\n    /**\n     * Restores hidden slides in the given flickity slider.\n     *\n     * @param {object} $slider\n     *   jQuery object for the flickity slider.\n     */\n    function restoreSliderThumbs($slider) {\n      if ($slider.hiddenSlides) {\n        $slider.find('li').show();\n        $slider.flickity('reposition');\n        $slider.flickity('selectCell', 0);\n        $slider.hiddenSlides = 0;\n      }\n    }\n\n  });\n})(jQuery);\n"],"sourceRoot":"assets/scripts/"}